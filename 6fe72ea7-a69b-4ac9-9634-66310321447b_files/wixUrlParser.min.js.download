"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};define("wixUrlParser/utils/urlParserUtils",["lodash","coreUtils"],function(e,t){function r(r){if(r.isResolvedSiteData)return r;var a=r.getCurrentUrlPageId(),i=e.get(r.getMasterPageData(),["data","document_data"]),n=e(i).filter({type:"PermaLink"}).keyBy("id").value(),o=e.keyBy(r.getPagesDataItems(),"id");o.masterPage=r.getDataByQuery("masterPage");var l={primaryPageId:r.getPrimaryPageId(),urlFormat:r.getUrlFormat(),mainPageId:r.getMainPageId(),externalBaseUrl:r.getExternalBaseUrl(),unicodeExternalBaseUrl:r.getUnicodeExternalBaseUrl(),publicBaseUrl:r.getPublicBaseUrl(),currentUrl:r.currentUrl,currentUrlPageId:a,isFeedbackEndpoint:r.isFeedbackEndpoint(),isSiteHistoryEndpoint:r.isSiteHistoryEndpoint(),isViewerMode:r.isViewerMode(),isWixSite:r.isWixSite(),languageCode:r.getLanguageCode(),isTemplate:r.isTemplate(),isUsingSlashUrlFormat:r.isUsingUrlFormat(t.siteConstants.URL_FORMATS.SLASH),isPremiumDomain:r.isPremiumDomain(),allPageIds:r.getAllPageIds(),routersConfigMap:e.get(r,"routers.configMap"),cookie:r.requestModel&&r.requestModel.cookie,serviceTopology:{basePublicUrl:r.getServiceTopologyProperty("basePublicUrl"),baseDomain:r.getServiceTopologyProperty("baseDomain"),staticDocsUrl:r.getServiceTopologyProperty("staticDocsUrl")},pagesDataItemsMap:o,permalinksMap:n,mapFromPageUriSeoToPageId:r.mapFromPageUriSeoToPageId,pageResponseForUrl:r.pageResponseForUrl,rootNavigationInfo:r.getRootNavigationInfo()};return l.isResolvedSiteData=!0,l}return{getResolvedSiteData:r}}),define("wixUrlParser/parsers/slashUrlParser",["lodash","coreUtils","experiment","wixUrlParser/utils/urlParserUtils"],function(e,t,r,a){function i(r){var a=t.urlUtils.parseUrl(r.externalBaseUrl).host;return e.endsWith(a,"."+t.siteConstants.FREE_DOMAIN.WIXSITE)||e.endsWith(a,"."+r.serviceTopology.baseDomain)}function n(e){return e.isPremiumDomain&&!i(e)}function o(r){var a=e.isObject(r.currentUrl)?r.currentUrl.full:t.urlUtils.parseUrl(r.currentUrl).full;return r.isTemplate&&e.startsWith(a,r.serviceTopology.basePublicUrl)}function l(e){return"object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.karmaIntegration?B.BEAKER:e.isFeedbackEndpoint?B.REVIEW:e.isSiteHistoryEndpoint?B.SITE_HISTORY:e.isViewerMode?n(e)?B.PREMIUM:e.isWixSite||o(e)?B.WIX_INTERNAL:B.FREE_SITE:B.PREVIEW}function s(t){return e.map(t,encodeURIComponent)}function p(t){return e.map(t,decodeURIComponent)}function u(t,r){var a=e.find(t.pagesDataItemsMap,{pageUriSEO:r});return a&&a.id}function d(a,i){var n=e.get(a.mapFromPageUriSeoToPageId,i);return r.isOpen("sv_dpages")?n||u(a,i)||t.errorPages.IDS.NOT_FOUND:n||u(a,i)||a.mainPageId}function g(r,a){var i=t.urlUtils.parseUrl(r.externalBaseUrl),n=i.path.replace(/\/$/,"").split("/").length;return a?e.drop(a.split("/"),n):[]}function c(e){return"_p"===e}function U(e,t){return!!t&&!!e.permalinksMap[t]}function f(e,t){var r=e.pagesDataItemsMap[t];return r&&"Page"===r.type&&r.tpaApplicationId>0}function I(e,t){var r=e.pagesDataItemsMap[t];return r&&"AppPage"===r.type&&"AppBuilderPage"===r.appPageType}function m(e,t){var r=e.pagesDataItemsMap[t];return r&&"AppPage"===r.type&&"AppPage"===r.appPageType&&"7326bfbb-4b10-4a8e-84c1-73f776051e10"===r.appPageId}function P(e,t){var r=e.pagesDataItemsMap[t];return r&&"AppPage"===r.type&&"AppPage"===r.appPageType&&"79f391eb-7dfc-4adf-be6e-64434c4838d9"===r.appPageId}function v(e,t){return P(e,t)||m(e,t)}function D(e){return e&&e.replace(/^https?:\/\//,"")}function S(e,r){var a=D(t.urlUtils.getBaseUrlWithPath(r,l(e)));return t.urlUtils.isSame(a,D(e.externalBaseUrl))||t.urlUtils.isSame(a,D(e.unicodeExternalBaseUrl))||t.urlUtils.isHostnameYandexWebvisor(a)||/^s3\.amazonaws\.com\/wix\-/.test(a)}function y(t,r){if(r)return e.find(t.routersConfigMap,{prefix:r})}function E(e){var r=e.query.q,a=/\:([^\:]+)\+$/.exec(r);return a&&a[1]&&t.urlUtils.parseUrl(a[1])||e}function h(a,i){var n=e.isObject(i)?i:t.urlUtils.parseUrl(i);if("webcache.googleusercontent.com"===n.hostname&&(n=E(n)),!S(a,n))return null;var o=g(a,n.path),l=e.head(o),s=e.drop(o,1),u={format:t.siteConstants.URL_FORMATS.SLASH};if(r.isOpen("sv_dpages")){var U=y(a,l);U&&(u.routerDefinition=U,u.pageAdditionalData=l+"/"+s.join("/"))}if(r.isOpen("sv_dpages")&&u.routerDefinition){u.innerRoute=s.join("/");var m=a.pageResponseForUrl;m&&m.pageId&&(u.pageId=m.pageId,u.title=m.title)}else l?c(l)?(u.pageItemId=e.head(s),u.pageId=a.currentUrlPageId||a.mainPageId):(u.pageId=d(a,l),I(a,u.pageId)?u.title=o[2]:u.title=l):(u.pageId=a.mainPageId,u.title=R(a,u.pageId));return n.query.lightbox&&(u.pageItemId=n.query.lightbox,u.imageZoom=!0),!(o.length>1)||r.isOpen("sv_dpages")&&u.routerDefinition||(I(a,u.pageId)?u.pageAdditionalData=e.head(s):c(l)?u.pageAdditionalData=e.drop(s,1).join("/"):f(a,u.pageId)?u.pageAdditionalData=p(s).join("/"):u.pageAdditionalData=s.join("/")),u}function R(r,a){var i=r.pagesDataItemsMap[a];return e.get(i,"pageUriSEO")||t.siteConstants.DEFAULT_PAGE_URI_SEO}function A(t){return e.omit(t.currentUrl.query,F)}function b(t){var r=e.get(t,"rootNavigationInfo.pageAdditionalData");if(r){var a=r.split("/");return e.drop(a,1).join("/")}}function x(a,i,n,o,l,p){var u=A(a),d=l||a.externalBaseUrl;d=d.replace(/\/$/,"");var g=U(a,i.pageItemId);if(r.isOpen("sv_dpages")&&(i.routerId||i.routerDefinition)){"CURRENT_INNER_ROUTE"===i.innerRoute&&(i.innerRoute=b(a)||i.innerRoute);d+="/"+(i.routerId?e.get(a.routersConfigMap,i.routerId+".prefix"):i.routerDefinition.prefix),i.innerRoute&&"/"!==i.innerRoute&&(d+="/"+i.innerRoute)}else i.pageId&&!g&&(i.pageId!==a.mainPageId||n||i.pageAdditionalData)&&(d+="/"+R(a,i.pageId));if(I(a,i.pageId)&&i.pageAdditionalData)d+="/"+i.pageAdditionalData+(i.title?"/"+i.title:"");else if(f(a,i.pageId)&&i.pageAdditionalData)d+="/"+s(i.pageAdditionalData.split("/")).join("/");else if(v(a,i.pageId)&&i.pageAdditionalData){var c=e.findKey(e.get(p,"customUrlMapping"),{id:i.pageAdditionalData});d+=c?"/"+c:"/"+i.pageAdditionalData}return i.pageItemId&&(g?i.pageAdditionalData&&(d+="/_p/"+i.pageItemId+"/"+i.pageAdditionalData):i.imageZoom&&(u.lightbox=i.pageItemId)),o||e.isEmpty(u)||"webcache.googleusercontent.com"===a.currentUrl.hostname||(d+="?"+t.urlUtils.toQueryString(u)),d}function T(e,t){return h(a.getResolvedSiteData(e),t)}function M(e,t,r,i,n,o,l){return x(a.getResolvedSiteData(e),t,r,i,n,l)}function _(e,r){var i=t.urlUtils.parseUrl(r);return S(a.getResolvedSiteData(e),i)}var F=["lightbox"],B={PREVIEW:7,SITE_HISTORY:8,WIX_INTERNAL:2,FREE_SITE:1,PREMIUM:0,REVIEW:3,BEAKER:3};return{parseUrl:T,getUrl:M,isUrlToCurrentSite:_}}),define("wixUrlParser/parsers/hashBangUrlParser",["loggingUtils","coreUtils","lodash","wixUrlParser/utils/urlParserUtils"],function(e,t,r,a){function i(r){var a;return"string"==typeof r?a=t.urlUtils.parseUrl(r):r.full?a=r:e.log.error("url to parse has to be either a string or an object"),a}function n(e,t){return r.includes(e.allPageIds,t)}function o(e,t){var r={},a=e.match(/#!(.*?)\/zoom[\/\|](.+?)\/([^\/]+)$/i);if(!a){var i=e.match(/#!(.*?)[\/\|]([^\/]+)\/?(.*$)/i);if(i){var o=i[1],l=i[2],s=i[3];return o&&(r.title=o),n(t,l)?r.pageId=l:(r.pageId=t.primaryPageId||t.mainPageId,r.pageItemId=l),s&&(r.pageAdditionalData=s),r}return{pageId:t.mainPageId}}return a[1]&&(r.title=a[1]),r.pageId=a[2],r.pageItemId=a[3],r.imageZoom=!0,r}function l(e,a,i,n){var o=e.currentUrl,l=n||e.externalBaseUrl;l=l.replace("."+t.siteConstants.FREE_DOMAIN.WIXSITE+"/","."+t.siteConstants.FREE_DOMAIN.WIX+"/");var s=o.query;return i||r.isEmpty(s)||(l+="?"+t.urlUtils.toQueryString(s)),o.url=l,a.id&&(l+="#!"+a.title+"/"+a.id),a.additionalData&&(l+="/"+a.additionalData),l}function s(e,t){if(!t)return null;var a=i("#"===t?e.currentUrl:t),n="localhost"===a.hostname;return p(e,a)&&!n?e.currentUrl.full!==a.full||r.includes(a.full,"#")?null:{pageId:e.mainPageId}:(r.isString(t)&&0===t.indexOf("#!")&&(a=r.clone(e.currentUrl),a.hash=t),o(a.hash,e))}function p(e,r){return!(t.urlUtils.isHostnameYandexWebvisor(r.hostname)||g(e,r))}function u(e,t){var r=e.pagesDataItemsMap[t];return r&&"AppPage"===r.type&&"AppPage"===r.appPageType&&"7326bfbb-4b10-4a8e-84c1-73f776051e10"===r.appPageId}function d(e){return e&&e.replace(/^https?:\/\//,"")}function g(e,r){var a=r.hostname+r.path;return t.urlUtils.isSame(a,d(e.externalBaseUrl))||t.urlUtils.isSame(a,d(e.unicodeExternalBaseUrl))}function c(e,r,a,i,n,o){var s={title:r.title||t.siteConstants.DEFAULT_PAGE_URI_SEO};if(r.pageItemId&&!r.pageAdditionalData&&r.imageZoom?(s.id="zoom",s.additionalData=r.pageId+"/"+r.pageItemId):(r.pageId!==e.mainPageId||r.pageAdditionalData||a)&&(s.id=r.pageItemId||r.pageId,s.additionalData=r.pageAdditionalData),u(e,r.pageId)&&o){var p=r.pageAdditionalData||"",d=o[p]||o[decodeURIComponent(p)]||{};s.id=r.pageId,s.title=d.title,s.additionalData=d.id}return l(e,s,i,n)}function U(e,t){return s(a.getResolvedSiteData(e),t)}function f(e,t,r,i,n,o){return c(a.getResolvedSiteData(e),t,r,i,n,o)}function I(e,r){if("#"===r)return!0;var i=t.urlUtils.parseUrl(r);return g(a.getResolvedSiteData(e),i)}return{parseUrl:U,getUrl:f,isUrlToCurrentSite:I}}),define("wixUrlParser",["lodash","coreUtils","wixUrlParser/parsers/slashUrlParser","wixUrlParser/parsers/hashBangUrlParser","wixUrlParser/utils/urlParserUtils"],function(e,t,r,a,i){function n(r,a){var i=e.isObject(a)?a:t.urlUtils.parseUrl(a);return!t.stringUtils.startsWith(i.hash,"#!")&&r.isUsingSlashUrlFormat}function o(e,t){return g[t||e.urlFormat]||g[e.urlFormat]}function l(e,t){return t===e.replace(/\/$/,"")+"/app"}function s(e,t){var o=i.getResolvedSiteData(e);return!t||l(o.externalBaseUrl,t)?null:"#"===t?s(o,o.currentUrl.full):n(o,t)?r.parseUrl(o,t):a.parseUrl(o,t)}function p(e,t,r,a,n,l){var s=i.getResolvedSiteData(e);return o(s,t.format).getUrl(s,t,r,a,n,l,e)}function u(e,t){var o=i.getResolvedSiteData(e);return n(o,t)?r.isUrlToCurrentSite(o,t):a.isUrlToCurrentSite(o,t)}function d(e,t){if(u(e,t)){var r=e.currentUrl.protocol;return t.replace(/^https?:/,r)}return t}var g={slash:r,hashBang:a};return{getUrl:p,parseUrl:s,utils:i,normalizeProtocolForSameSite:d}});
//# sourceMappingURL=wixUrlParser.min.js.map