"use strict";define("mediaControls/mediaOverlayControls/mediaOverlayControls",["lodash","react","core","utils","santaProps","svgCommon"],function(e,t,s,i,o,r){var a=i.mediaConsts,n=r.transformToTintColors;return{displayName:"MediaOverlayControls",mixins:[s.compMixins.skinBasedComp],propTypes:{compProp:o.Types.Component.compProp,mediaAspect:o.Types.SiteAspects.mediaAspect.isRequired,handleBehavior:o.Types.Behaviors.handleBehavior.isRequired,iconsDescriptor:o.Types.MediaControls.iconsDescriptor,THEME_DATA:o.Types.Theme.THEME_DATA,isPlayingAllowed:o.Types.RenderFlags.isPlayingAllowed,playerInteraction:t.PropTypes.string,playerInHoverState:t.PropTypes.bool},statics:{useSantaTypes:!0},getDefaultProps:function(){return{playerInteraction:"click",playerInHoverState:!1}},getInitialState:function(){return{playbackState:a.playbackTypes.WAITING,showReplay:!1,showPlay:!0}},componentDidMount:function(){this.props.compProp.playerId&&this.props.mediaAspect.registerStateChange(this.props.id,this.props.compProp.playerId,this.onStateChange)},componentWillUnmount:function(){this.props.mediaAspect.unregisterStateChange(this.props.id,this.props.compProp.playerId)},componentWillReceiveProps:function(e){var t=this.props.compProp.playerId,s=e.compProp.playerId;t!==s&&this.props.mediaAspect.unregisterStateChange(this.props.id,t),s&&this.props.mediaAspect.registerStateChange(this.props.id,s,this.onStateChange),e.isPlayingAllowed||this.setState({showReplay:!1,showPlay:!0})},onStateChange:function(t){var s={};this.state.playbackState!==t.playbackState&&(s.playbackState=t.playbackState),this.state.showPlay&&t.currentTime>0&&(s.showPlay=!1),t.currentTime>=t.duration?s.showReplay=!0:this.state.showReplay&&(s.showReplay=!1),e.isEmpty(s)||this.setState(s)},clickAction:function(){var e=this.state.playbackState===a.playbackTypes.PLAYING;this.state.showPlay||this.state.showReplay?this.setState({showPauseIndicator:!1,showPlayIndicator:!1}):this.setState({showPauseIndicator:e,showPlayIndicator:!e})},getIconSymbolName:function(){var e=this.props.playerInteraction;return this.state.showPlay?"playButton":this.state.showReplay?"replayButton":this.state.showPlayIndicator&&"click"===e?"playIndication":this.state.showPauseIndicator&&"click"===e?"pauseIndication":null},getIconComponent:function(){var t=this.getIconSymbolName();if(!t)return null;var s={skin:"skins.viewer.svgPrimitive.SvgPrimitiveDefaultSkin",styleId:this.props.styleId+"_"+t},o=e.get(this.props,["compTheme","style","properties","fillcolor"]),r=i.colorParser.getColorValue(this.props.THEME_DATA,o),a=n(this.props.iconsDescriptor[t],r),p={id:this.props.id+"indicator",key:t,ref:"indicator",svgString:a,className:this.classSet({indicator:!0,hover:this.props.playerInHoverState})};return this.createChildComponent(this.props.compData,"wysiwyg.viewer.components.svgPrimitive",s,p)},getCatcherProperties:function(){var e={};return"click"===this.props.playerInteraction&&(e.onClick=this.clickAction),e},getSkinProperties:function(){return{"":{style:this.props.style,"data-player-id":this.props.compProp.playerId},indicator:this.getIconComponent(),catcher:this.getCatcherProperties()}}}}),define("mediaControls/mediaControlPlay/mediaControlPlay",["react","core","utils","santaProps"],function(e,t,s,i){function o(e){return e===a.playbackTypes.PLAYING||e===a.playbackTypes.SEEK_PLAYING}function r(e){return o(e)?"pause":"play"}var a=s.mediaConsts;return{displayName:"MediaControlPlay",mixins:[t.compMixins.skinBasedComp],propTypes:{style:e.PropTypes.object,playerId:e.PropTypes.string.isRequired,iconsDescriptor:e.PropTypes.object,mediaAspect:i.Types.SiteAspects.mediaAspect.isRequired,handleBehavior:i.Types.Behaviors.handleBehavior.isRequired},statics:{useSantaTypes:!0},getInitialState:function(){return{playbackState:a.playbackTypes.WAITING}},componentDidMount:function(){this.props.mediaAspect.registerStateChange(this.props.id,this.props.playerId,this.setPlaybackState)},componentWillUnmount:function(){this.props.mediaAspect.unregisterStateChange(this.props.id,this.props.playerId)},setPlaybackState:function(e){this.state.playbackState!==e.playbackState&&this.setState({playbackState:e.playbackState})},clickAction:function(){this.props.handleBehavior({type:"comp",targetId:this.props.playerId,name:r(this.state.playbackState)})},getIconComponent:function(e){var t={skin:"skins.viewer.svgPrimitive.SvgPrimitiveDefaultSkin",styleId:this.props.styleId+"_"+e},s={id:this.props.id+"icon",ref:"icon",svgString:this.props.iconsDescriptor[e]};return this.createChildComponent(this.props.compData,"wysiwyg.viewer.components.svgPrimitive",t,s)},getSkinProperties:function(){return{"":{style:this.props.style},playButton:{children:this.getIconComponent(r(this.state.playbackState)),onClick:this.clickAction}}}}}),define("mediaControls/mediaControlFullscreen/mediaControlFullscreen",["react","core","santaProps"],function(e,t,s){function i(e){return e?"exitFullscreen":"fullscreen"}return{displayName:"MediaControlFullscreen",mixins:[t.compMixins.skinBasedComp],propTypes:{style:e.PropTypes.object,playerId:e.PropTypes.string.isRequired,enableFullsceen:e.PropTypes.bool,mediaAspect:s.Types.SiteAspects.mediaAspect.isRequired,handleBehavior:s.Types.Behaviors.handleBehavior.isRequired},statics:{useSantaTypes:!0},getInitialState:function(){return{fullscreen:!1}},componentDidMount:function(){this.props.mediaAspect.registerStateChange(this.props.id,this.props.playerId,this.setFullscreenState)},componentWillUnmount:function(){this.props.mediaAspect.unregisterStateChange(this.props.id,this.props.playerId)},setFullscreenState:function(e){this.state.fullscreen!==e.fullscreen&&this.setState({fullscreen:e.fullscreen})},clickAction:function(){this.props.handleBehavior({type:"comp",targetId:this.props.playerId,name:this.state.fullscreen?"exitFullscreen":"enterFullscreen"})},getIconComponent:function(e){var t={skin:"skins.viewer.svgPrimitive.SvgPrimitiveDefaultSkin",styleId:this.props.styleId+"_"+e},s={id:this.props.id+"icon",ref:"icon",svgString:this.props.iconsDescriptor[e]};return this.createChildComponent(this.props.compData,"wysiwyg.viewer.components.svgPrimitive",t,s)},getSkinProperties:function(){var e={"":{style:this.props.style},fullscreenButton:{children:this.getIconComponent(i(this.state.fullscreen)),className:this.classSet({"video-fullscreen":this.state.fullscreen,"video-windowed":!this.state.fullscreen,disabled:!this.props.enableFullsceen})}};return this.props.enableFullsceen&&(e.fullscreenButton.onClick=this.clickAction),e}}}),define("mediaControls/mediaControlVolume/mediaControlVolume",["lodash","react","core","coreUtils","santaProps"],function(e,t,s,i,o){function r(e){return e?"volumeOff":"volumeOn"}var a=i.SimpleDrag;return{displayName:"MediaControlVolume",mixins:[s.compMixins.skinBasedComp],propTypes:{style:t.PropTypes.object,playerId:t.PropTypes.string.isRequired,mediaAspect:o.Types.SiteAspects.mediaAspect.isRequired,handleBehavior:o.Types.Behaviors.handleBehavior.isRequired},statics:{useSantaTypes:!0},getInitialState:function(){return this.isDragging=!1,{muted:!1,volume:0}},componentDidMount:function(){this.props.mediaAspect.registerStateChange(this.props.id,this.props.playerId,this.setVolumeState)},componentWillUnmount:function(){this.props.mediaAspect.unregisterStateChange(this.props.id,this.props.playerId)},setVolumeState:function(e){this.isDragging||this.state.volume===e.volume&&this.state.muted===e.muted||this.setState({muted:e.muted,volume:e.volume})},clickActionMute:function(){var e=this.state.muted?"unMute":"mute";this.props.handleBehavior({type:"comp",targetId:this.props.playerId,name:e})},setVolumeOnSeek:function(e){this.props.handleBehavior({type:"comp",targetId:this.props.playerId,name:"setVolume",params:{volume:e.endX/e.maxX}})},onDragStart:function(e,t){this.isDragging=!0,this.refs.volumeBarActive.style.width=t.endX/t.maxX*100+"%",this.setVolumeOnSeek(t)},onDrag:function(e,t){this.refs.volumeBarActive.style.width=t.endX/t.maxX*100+"%",this.setVolumeOnSeek(t)},onDragEnd:function(e,t){this.isDragging=!1,this.setVolumeOnSeek(t)},volumeSeekStart:function(e){a({onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDrag:this.onDrag,minX:0,maxX:e.target.offsetWidth,offsetX:e.nativeEvent.layerX}).start(e)},getIconComponent:function(e){var t={skin:"skins.viewer.svgPrimitive.SvgPrimitiveDefaultSkin",styleId:this.props.styleId+"_"+e},s={id:this.props.id+"icon",ref:"icon",svgString:this.props.iconsDescriptor[e]};return this.createChildComponent(this.props.compData,"wysiwyg.viewer.components.svgPrimitive",t,s)},getSkinProperties:function(){var t={"":{style:this.props.style},volume:{className:this.classSet({muted:this.state.muted})},mute:{children:this.getIconComponent(r(this.state.muted)),onClick:this.clickActionMute},volumeBarActive:{style:{width:100*this.state.volume+"%"}}};return this.state.muted||e.assign(t,{volumeBarDragArea:{onMouseDown:this.volumeSeekStart}}),t}}}),define("mediaControls/mediaControlStoryboard/mediaControlStoryboard",["lodash","react","core","santaProps"],function(e,t,s,i){function o(e){var t=new Date(1e3*e),s=t.getUTCHours(),i=t.getUTCMinutes(),o=t.getUTCSeconds();return o<10&&(o="0"+o),s?(i<10&&(i="0"+i),s+":"+i+":"+o):i+":"+o}return{displayName:"MediaControlStoryboard",mixins:[s.compMixins.skinBasedComp],propTypes:{style:t.PropTypes.object,videoId:t.PropTypes.string,serviceTopologyStaticVideoUrl:i.Types.ServiceTopology.staticVideoUrl,getMediaQualityState:i.Types.Media.getMediaQualityState,visible:t.PropTypes.bool,showVideo:t.PropTypes.bool},statics:{useSantaTypes:!0},componentWillUpdate:function(t){if(this.props.showVideo&&t.videoId){var s=this.props.getMediaQualityState(t.videoId),i=e.get(s,"storyboardUrl");i&&(this.storyboardUrl=this.props.serviceTopologyStaticVideoUrl+i)}},componentDidUpdate:function(e,t){if(this.props.showVideo){var s=this.refs.video;this.storyboardUrl!==s.currentSrc&&s.load(),s&&t.time!==this.state.time&&(s.currentTime=this.state.time)}},getInitialState:function(){return this.storyboardUrl="",{time:0,left:0}},getSkinProperties:function(){var s=this.props.visible?{display:"block"}:{display:"none"},i=e.defaults({left:this.state.left},this.props.style,s);return this.props.showVideo?{"":{style:i},video:{},mediaSource:{src:this.storyboardUrl},label:{children:[t.createElement("span",null,o(this.state.time))]}}:{"":{style:i},label:{children:[t.createElement("span",null,o(this.state.time))]}}}}}),define("mediaControls/mediaControlProgress/mediaControlProgress",["lodash","react","core","coreUtils","santaProps","mediaControls/mediaControlStoryboard/mediaControlStoryboard"],function(e,t,s,i,o,r){function a(t){return e.includes(l,t)}var n=i.mediaConsts,p=i.SimpleDrag,l=[n.playbackTypes.SEEK_PLAYING,n.playbackTypes.SEEK_PAUSED,n.playbackTypes.SEEKING];return{displayName:"MediaControlProgress",mixins:[s.compMixins.skinBasedComp],propTypes:e.defaults({style:t.PropTypes.object,playerId:t.PropTypes.string.isRequired,mediaAspect:o.Types.SiteAspects.mediaAspect.isRequired,handleBehavior:o.Types.Behaviors.handleBehavior.isRequired,showStoryboard:t.PropTypes.string},o.santaTypesUtils.getSantaTypesByDefinition(r)),statics:{useSantaTypes:!0},getInitialState:function(){return this.isDragging=!1,{playbackState:n.playbackTypes.WAITING,currentTime:0,progress:0,duration:0,isStoryboardVisible:!1}},getDefaultProps:function(){return{showVideoInStoryboard:!0}},componentDidMount:function(){this.props.mediaAspect.registerStateChange(this.props.id,this.props.playerId,this.setState.bind(this))},componentWillUnmount:function(){this.props.mediaAspect.unregisterStateChange(this.props.id,this.props.playerId)},onSeekStart:function(e,t){this.isDragging=!0,this.refs.playHead.style.left=t.endX/t.maxX*100+"%",this.props.handleBehavior({type:"comp",targetId:this.props.playerId,name:"seekStart"})},onSeekEnd:function(e,t){var s=t.endX/t.maxX*this.state.duration;this.props.handleBehavior({type:"comp",targetId:this.props.playerId,name:"seekEnd",params:{time:s}}),this.isDragging=!1},onSeek:function(e,t){this.refs.playHead.style.left=t.endX/t.maxX*100+"%"},seekStartDrag:function(e){p({onDragStart:this.onSeekStart,onDragEnd:this.onSeekEnd,onDrag:this.onSeek,minX:0,maxX:e.target.offsetWidth,offsetX:e.nativeEvent.layerX}).start(e)},getStoryboardComp:function(e){if(!e||"none"===e)return null;var t="videoAndTime"===e,s=t?"storyboard":"storyboardMinimal",i={ref:"storyboard",id:this.props.id+"storyboard",videoId:this.state.videoId,visible:this.state.isStoryboardVisible,showVideo:t};return this.createChildComponent(null,"wysiwyg.viewer.components.MediaControlStoryboard",s,i)},onStoryboardStart:function(){this.setState({isStoryboardVisible:!0})},onStoryboardEnd:function(){this.setState({isStoryboardVisible:!1})},onStoryboardScrub:function(e,t){this.refs.storyboard.setState({left:t.endX,time:t.endX/t.maxX*this.state.duration})},storyboardStartScrub:function(e){p({onDragStart:this.onStoryboardStart,onDragEnd:this.onStoryboardEnd,onDrag:this.onStoryboardScrub,minX:0,maxX:e.target.offsetWidth,offsetX:e.clientX-e.currentTarget.getBoundingClientRect().left}).start(e)},getPlayHeadPosition:function(){return this.isDragging||a(this.state.playbackState)?this.refs.playHead.style.left:this.state.currentTime/this.state.duration*100+"%"},getIconComponent:function(e){var t={skin:"skins.viewer.svgPrimitive.SvgPrimitiveDefaultSkin",styleId:this.props.styleId+"_"+e},s={id:this.props.id+"icon",ref:"icon",svgString:this.props.iconsDescriptor[e]};return this.createChildComponent(this.props.compData,"wysiwyg.viewer.components.svgPrimitive",t,s)},getSkinProperties:function(){var e=this.getPlayHeadPosition();return{"":{style:this.props.style},progressDragArea:{onMouseDown:this.seekStartDrag,onMouseEnter:this.storyboardStartScrub},progressLoad:{style:{width:this.state.progress/this.state.duration*100+"%"}},progressPlay:{style:{width:this.state.currentTime/this.state.duration*100+"%"}},playHead:{children:this.getIconComponent("playhead"),style:{left:e},className:this.classSet({"play-head-animate":!this.isDragging})},storyboard:this.getStoryboardComp(this.props.showStoryboard)}}}}),define("mediaControls/mediaControlTime/mediaControlTime",["react","core","santaProps"],function(e,t,s){function i(e){var t=new Date(1e3*e),s=t.getUTCHours(),i=t.getUTCMinutes(),o=t.getUTCSeconds();return o<10&&(o="0"+o),s?(i<10&&(i="0"+i),s+":"+i+":"+o):i+":"+o}return{displayName:"MediaControlTime",mixins:[t.compMixins.skinBasedComp],propTypes:{style:e.PropTypes.object,playerId:e.PropTypes.string.isRequired,mediaAspect:s.Types.SiteAspects.mediaAspect.isRequired},statics:{useSantaTypes:!0},getInitialState:function(){return{currentTime:0,duration:0}},componentDidMount:function(){this.props.mediaAspect.registerStateChange(this.props.id,this.props.playerId,this.setState.bind(this))},componentWillUnmount:function(){this.props.mediaAspect.unregisterStateChange(this.props.id,this.props.playerId)},getSkinProperties:function(){return{"":{style:this.props.style},played:{children:[i(this.state.currentTime)]},total:{children:[i(this.state.duration)]}}}}}),define("mediaControls/mediaControlsContainer/mediaControlsContainer",["react","lodash","core","santaProps","utils","mediaControls/mediaControlPlay/mediaControlPlay","mediaControls/mediaControlFullscreen/mediaControlFullscreen","mediaControls/mediaControlVolume/mediaControlVolume","mediaControls/mediaControlProgress/mediaControlProgress","mediaControls/mediaControlTime/mediaControlTime"],function(e,t,s,i,o,r,a,n,p,l){var c=o.mediaConsts,d={play:{componentName:"wysiwyg.viewer.components.MediaControlPlay",style:{width:40,height:40}},volume:{componentName:"wysiwyg.viewer.components.MediaControlVolume",style:{width:120,height:40}},fullscreen:{componentName:"wysiwyg.viewer.components.MediaControlFullscreen",style:{width:40,height:40}},progress:{componentName:"wysiwyg.viewer.components.MediaControlProgress",style:{width:240,height:40}},time:{componentName:"wysiwyg.viewer.components.MediaControlTime",style:{width:120,height:40}}};return{displayName:"MediaControls",mixins:[s.compMixins.skinBasedComp],propTypes:t.defaults({id:i.Types.Component.id.isRequired,mediaAspect:i.Types.SiteAspects.mediaAspect.isRequired,iconsDescriptor:i.Types.MediaControls.iconsDescriptor,compProp:i.Types.Component.compProp,componentViewMode:i.Types.RenderFlags.componentViewMode.isRequired,enableFullsceen:e.PropTypes.bool,playerInTimedHoverState:e.PropTypes.bool,playerInHoverState:e.PropTypes.bool},i.santaTypesUtils.getSantaTypesByDefinition(r),i.santaTypesUtils.getSantaTypesByDefinition(a),i.santaTypesUtils.getSantaTypesByDefinition(n),i.santaTypesUtils.getSantaTypesByDefinition(p),i.santaTypesUtils.getSantaTypesByDefinition(l)),statics:{useSantaTypes:!0},getInitialState:function(){return{playbackState:c.playbackTypes.WAITING}},getDefaultProps:function(){return{enableFullsceen:!1,playerInHoverState:!1}},componentDidMount:function(){this.props.compProp.playerId&&this.props.mediaAspect.registerStateChange(this.props.id,this.props.compProp.playerId,this.setPlaybackState)},componentWillUnmount:function(){this.props.mediaAspect.unregisterStateChange(this.props.id,this.props.compProp.playerId)},componentWillReceiveProps:function(e){this.props.compProp.playerId!==e.compProp.playerId&&this.props.mediaAspect.unregisterStateChange(this.props.id,this.props.compProp.playerId),e.compProp.playerId&&this.props.mediaAspect.registerStateChange(this.props.id,this.props.compProp.playerId,this.setPlaybackState)},setPlaybackState:function(e){this.state.playbackState!==e.playbackState&&this.setState({playbackState:e.playbackState})},getControl:function(e,s){var i=d[e].componentName,o=e,r=t.assign({ref:e,skinPart:e,id:this.props.id+e,playerId:this.props.compProp.playerId,iconsDescriptor:this.props.iconsDescriptor,style:d[e].style},s);return this.createChildComponent(null,i,o,r)},getSkinProperties:function(){var e=this.state.playbackState===c.playbackTypes.PLAYING,t=this.state.playbackState!==c.playbackTypes.LOADING&&this.state.playbackState!==c.playbackTypes.READY;return{"":{style:this.props.style,"data-player-id":this.props.compProp.playerId,onClick:function(e){e.stopPropagation()}},controls:{className:this.classSet({"video-playing":e,"video-paused":!e,"video-controls":"preview"!==this.props.componentViewMode||t,"visible-controls":"preview"!==this.props.componentViewMode||this.props.playerInHoverState&&this.props.playerInTimedHoverState})},play:this.getControl("play"),volume:this.getControl("volume"),fullscreen:this.props.enableFullsceen?this.getControl("fullscreen"):{style:{display:"none"}},progress:this.getControl("progress",{showStoryboard:this.props.compProp.showStoryboard}),time:this.getControl("time")}}}}),define("mediaControls/utils/mediaControlsDataRequiermentsChecker",["core","lodash","utils"],function(e,t,s){function i(e,s){if(!t.has(e.svgShapes,s))return a.createSvgFetchRequest(e.serviceTopology.mediaRootUrl,e.svgShapes,s)}function o(e,s){var o=t.get(s,["style","style","properties"]),r=t.filter(o,function(e){return t.startsWith(e,"svgshape")}),a=t.map(r,function(t){return i(e,t)});return t.compact(a)}var r=e.dataRequirementsChecker,a=s.svg;r.registerCheckerForCompType("wysiwyg.viewer.components.MediaOverlayControls",o),r.registerCheckerForCompType("wysiwyg.viewer.components.MediaControls",o)}),define("mediaControls",["mediaControls/mediaOverlayControls/mediaOverlayControls","mediaControls/mediaControlsContainer/mediaControlsContainer","mediaControls/mediaControlPlay/mediaControlPlay","mediaControls/mediaControlFullscreen/mediaControlFullscreen","mediaControls/mediaControlVolume/mediaControlVolume","mediaControls/mediaControlProgress/mediaControlProgress","mediaControls/mediaControlTime/mediaControlTime","mediaControls/mediaControlStoryboard/mediaControlStoryboard","mediaControls/utils/mediaControlsDataRequiermentsChecker"],function(e,t,s,i,o,r,a,n){return{mediaOverlayControls:e,mediaControls:t,mediaControlPlay:s,mediaControlFullscreen:i,mediaControlVolume:o,mediaControlProgress:r,mediaControlTime:a,mediaControlStoryboard:n}});
//# sourceMappingURL=mediaControls.min.js.map